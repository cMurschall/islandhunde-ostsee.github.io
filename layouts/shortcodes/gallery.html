<link rel="stylesheet" href="/css/lightgallery-bundle.min.css" />
<link rel="stylesheet" href="/css/lg-thumbnail.css" />
<script src="/js/lightgallery.umd.js" defer></script>
<script src="/js/lg-thumbnail.umd.js" defer></script>

{{/* 1. Page Resources */}}
{{ $jpg := .Page.Resources.Match "**.jpg" }}
{{ $jpeg := .Page.Resources.Match "**.jpeg" }}
{{ $png := .Page.Resources.Match "**.png" }}
{{ $webp := .Page.Resources.Match "**.webp" }}
{{ $bundleImages := $jpg | append $jpeg | append $png | append $webp }}

{{/* 2. Statische Bilder aus .Params.images */}}
{{ $staticImages := .Page.Params.images | default slice }}
{{ $allImages := $bundleImages | append $staticImages }}

{{ if gt (len $allImages) 0 }}
  {{ $first := index $allImages 0 }}
  {{ $firstUrl := "" }}
  {{ if (in (printf "%T" $first) "resource") }}
    {{ $firstUrl = $first.RelPermalink }}
  {{ else }}
    {{ $firstUrl = $first }}
  {{ end }}

  <div id="lightgallery" class="gallery-single">
    <a href="{{ $firstUrl }}" data-lg-size="1400-933" class="has-overlay">
      <div class="overlay-icon">➤ Galerie öffnen</div>
      <img src="{{ $firstUrl }}" alt="" loading="lazy" />
    </a>

    <!-- weitere Bilder -->
    {{ range $i, $img := $allImages }}
      {{ if gt $i 0 }}
        {{ $url := "" }}
        {{ if (in (printf "%T" $img) "resource") }}
          {{ $url = $img.RelPermalink }}
        {{ else }}
          {{ $url = $img }}
        {{ end }}
        <a href="{{ $url }}" data-lg-size="1400-933" style="display:none;">
          <img src="{{ $url }}" alt="" />
        </a>
      {{ end }}
    {{ end }}
  </div>
{{ end }}

<script>
  window.addEventListener("DOMContentLoaded", function () {
    if (window.lightGallery) {
      lightGallery(document.getElementById("lightgallery"), {
        selector: "a",
        speed: 300,
        download: false,
        plugins: [lgThumbnail],
        thumbnail: true,
        loop: true,
        controls: true,
        counter: true,
      });
    }
  });
</script>

<style>
  .gallery-single img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
    transition: transform 0.2s ease;
    cursor: pointer;
  }
  .gallery-single img:hover {
    transform: scale(1.02);
  }
</style>
